<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalles Administrativos - Sucursal</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(to right, #00aaff, #00d9c2);
            font-family: 'Arial', sans-serif;
        }

        #logo {
            width: 200px;
            height: auto;
            margin: 30px auto;
            display: block;
        }

        .container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 20px;
        }

        .card {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }

        .card h2 {
            font-size: 32px;
            font-weight: 700;
            color: #00aaff;
            margin-bottom: 20px;
        }

        .btn {
            padding: 12px 25px;
            background-color: #28a745;
            color: #fff;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .btn:hover {
            background-color: #218838;
        }

        .venta-card {
            background-color: #fff;
            padding: 20px;
            border-radius: 12px;
            width: 30%;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        .venta-card h3 {
            font-size: 24px;
            font-weight: 600;
            color: #00aaff;
        }

        .venta-card p {
            font-size: 18px;
            color: #333;
            font-weight: bold;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 40px;
        }

        table th, table td {
            padding: 12px;
            text-align: left;
            border: 1px solid #ddd;
            font-size: 16px;
        }

        table th {
            background-color: #00aaff;
            color: #fff;
        }

        table tbody tr:hover {
            background-color: #f1f1f1;
        }

        .filter-select {
            padding: 10px;
            margin: 10px 0;
            width: 100%;
            max-width: 200px;
            background-color: #fff;
            border: 1px solid #ccc;
            border-radius: 8px;
        }

        /* Responsivo */
        @media (max-width: 768px) {
            .venta-card {
                width: 100%;
                margin-bottom: 20px;
            }

            table th, table td {
                font-size: 14px;
                padding: 8px;
            }
        }

        /* Estilos para el modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #fff;
            padding: 30px;
            border-radius: 12px;
            width: 60%;
            max-width: 500px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .modal-content input,
        .modal-content select {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-size: 16px;
        }

        .modal-content button {
            width: 100%;
            padding: 12px;
            background-color: #28a745;
            color: #fff;
            border-radius: 8px;
            border: none;
            font-size: 16px;
            cursor: pointer;
        }

        .modal-content button:hover {
            background-color: #218838;
        }

        /* Estilo para el cierre del modal */
        .close-btn {
            background-color: #dc3545;
            margin-top: 10px;
        }

        .close-btn:hover {
            background-color: #c82333;
        }
    </style>
</head>
<body>
    <!-- Logo en la parte superior -->
    <img id="logo" src="/pos/Frontend/imagenes/logo.JPG" alt="Logo">

    <div class="container">
        <!-- Filtros -->
        <div class="select-filters">
            <select id="filterFecha" class="filter-select">
                <option value="hoy">Filtrar por Fecha: Hoy</option>
                <option value="semana">Filtrar por Fecha: Esta Semana</option>
                <option value="mes">Filtrar por Fecha: Este Mes</option>
            </select>
            <select id="filterFormaPago" class="filter-select">
                <option value="todos">Filtrar por Forma de Pago: Todos</option>
                <option value="efectivo">Filtrar por Forma de Pago: Efectivo</option>
                <option value="tarjeta">Filtrar por Forma de Pago: Tarjeta</option>
            </select>
            <select id="filterVendedor" class="filter-select">
                <!-- Estos vendedores cambian dependiendo de la sucursal -->
            </select>
        </div>

        <!-- Datos dinámicos de la sucursal seleccionada -->
        <div id="sucursalData" class="card">
            <!-- Esto se llenará dinámicamente con JS -->
        </div>
    </div>

    <div class="container">
        <div class="card">
            <h2 class="text-center text-xl">Lista de Vendedores</h2>
            <button class="btn" onclick="openAddVendorModal()">Agregar Vendedor</button>
            
            <table id="vendorsTable">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>Email</th>
                        <th>Sucursal</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Los vendedores se llenarán aquí mediante JavaScript -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Modal para agregar vendedor -->
    <div id="addVendorModal" class="modal">
        <div class="modal-content">
            <h3 class="text-center font-bold">Agregar Vendedor</h3>
            <form id="addVendorForm">
                <label for="vendorName">Nombre:</label>
                <input type="text" id="vendorName" required>

                <label for="vendorEmail">Correo Electrónico:</label>
                <input type="email" id="vendorEmail" required>

                <label for="vendorPassword">Contraseña:</label>
                <input type="password" id="vendorPassword" required>

                <label for="vendorSucursal">Sucursal:</label>
                <input type="text" id="vendorSucursal" readonly required>

                <button type="submit" class="btn">Guardar Vendedor</button>
                <button type="button" class="btn close-btn" onclick="closeModal()">Cerrar</button>
            </form>
        </div>
    </div>

    <!-- Modal para editar vendedor -->
    <div id="editVendorModal" class="modal">
        <div class="modal-content">
            <h3 class="text-center font-bold">Editar Vendedor</h3>
            <form id="editVendorForm">
                <label for="editVendorName">Nombre:</label>
                <input type="text" id="editVendorName" required>

                <label for="editVendorEmail">Correo Electrónico:</label>
                <input type="email" id="editVendorEmail" required>

                <label for="editVendorPassword">Contraseña:</label>
                <input type="password" id="editVendorPassword" required>

                <label for="editVendorSucursal">Sucursal:</label>
                <input type="text" id="editVendorSucursal" readonly required>

                <button type="submit" class="btn">Guardar Cambios</button>
                <button type="button" class="btn close-btn" onclick="closeEditModal()">Cerrar</button>
            </form>
        </div>
    </div>

    <script>
        const sucursalData = document.getElementById('sucursalData');
        const filterFecha = document.getElementById('filterFecha');
        const filterFormaPago = document.getElementById('filterFormaPago');
        const filterVendedor = document.getElementById('filterVendedor');
        const vendorsTable = document.getElementById('vendorsTable').getElementsByTagName('tbody')[0];

        // Datos simulados para la sucursal seleccionada
        const sucursalInfo = {
            1: {
                nombre: "Sucursal 1",
                ventasTotales: "$5000.00",
                ventasEfectivo: "$2000.00",
                ventasTarjeta: "$3000.00",
                vendedores: ["Juan", "Carlos", "Ana"],
                detallesVentas: [
                    { hora: "10:30", vendedor: "Juan", formaPago: "Efectivo", total: "$1000.00" },
                    { hora: "11:00", vendedor: "Carlos", formaPago: "Tarjeta", total: "$1500.00" },
                    { hora: "12:15", vendedor: "Ana", formaPago: "Efectivo", total: "$2000.00" }
                ]
            },
            2: {
                nombre: "Sucursal 2",
                ventasTotales: "$3000.00",
                ventasEfectivo: "$1000.00",
                ventasTarjeta: "$2000.00",
                vendedores: ["Luis", "Sara"],
                detallesVentas: [
                    { hora: "09:30", vendedor: "Luis", formaPago: "Efectivo", total: "$1000.00" },
                    { hora: "11:00", vendedor: "Sara", formaPago: "Tarjeta", total: "$2000.00" }
                ]
            },
            3: {
                nombre: "Sucursal 3",
                ventasTotales: "$4000.00",
                ventasEfectivo: "$1500.00",
                ventasTarjeta: "$2500.00",
                vendedores: ["Pedro", "Lucía"],
                detallesVentas: [
                    { hora: "10:00", vendedor: "Pedro", formaPago: "Efectivo", total: "$1500.00" },
                    { hora: "12:30", vendedor: "Lucía", formaPago: "Tarjeta", total: "$2500.00" }
                ]
            }
        };

        // Obtener el parámetro de la URL para determinar la sucursal seleccionada
        const urlParams = new URLSearchParams(window.location.search);
        const sucursalId = urlParams.get('sucursal'); // Sucursal 1, 2 o 3

        // Cargar datos de la sucursal seleccionada
        function loadSucursalData(sucursalId) {
            const sucursal = sucursalInfo[sucursalId];

            if (sucursal) {
                // Cargar los filtros de vendedores para la sucursal seleccionada
                filterVendedor.innerHTML = '<option value="todos">Filtrar por Vendedor: Todos</option>';
                sucursal.vendedores.forEach(vendedor => {
                    const option = document.createElement('option');
                    option.value = vendedor;
                    option.textContent = vendedor;
                    filterVendedor.appendChild(option);
                });

                // Llenar los detalles de la sucursal
                sucursalData.innerHTML = `
                    <h2>${sucursal.nombre}</h2>
                    <div class="ventas-section">
                        <div class="venta-card">
                            <h3>Ventas Totales</h3>
                            <p>${sucursal.ventasTotales}</p>
                        </div>
                        <div class="venta-card">
                            <h3>Ventas con Efectivo</h3>
                            <p>${sucursal.ventasEfectivo}</p>
                        </div>
                        <div class="venta-card">
                            <h3>Ventas con Tarjeta</h3>
                            <p>${sucursal.ventasTarjeta}</p>
                        </div>
                    </div>
                    <h3>Detalles de Ventas</h3>
                    <table>
                        <thead>
                            <tr>
                                <th>Hora</th>
                                <th>Vendedor</th>
                                <th>Forma de Pago</th>
                                <th>Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${sucursal.detallesVentas.map(venta => `
                                <tr>
                                    <td>${venta.hora}</td>
                                    <td>${venta.vendedor}</td>
                                    <td>${venta.formaPago}</td>
                                    <td>${venta.total}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                `;

                // Set the hidden sucursal value when adding a vendor
                document.getElementById('vendorSucursal').value = sucursalId;
            }
        }

        // Cargar la sucursal de acuerdo al parámetro de URL
        loadSucursalData(sucursalId);

        // Agregar Vendedor a la tabla
        document.getElementById('addVendorForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const nombre = document.getElementById('vendorName').value;
            const email = document.getElementById('vendorEmail').value;
            const sucursal = document.getElementById('vendorSucursal').value;
            const password = document.getElementById('vendorPassword').value;

            // Aquí enviarías los datos al servidor, pero por ahora solo los agregamos a la tabla
            const row = vendorsTable.insertRow();
            row.insertCell(0).textContent = nombre;
            row.insertCell(1).textContent = email;
            row.insertCell(2).textContent = sucursal === '1' ? 'Sucursal 1' : sucursal === '2' ? 'Sucursal 2' : 'Sucursal 3';
            const accionesCell = row.insertCell(3);
            accionesCell.innerHTML = `<button class="btn" onclick="openEditVendorModal(this)">Editar</button> <button class="btn" onclick="deleteVendor(this)">Eliminar</button>`;
            closeModal();
        });

        // Mostrar el modal de agregar vendedor
        function openAddVendorModal() {
            document.getElementById('addVendorModal').style.display = 'flex';
        }

        // Mostrar el modal de editar vendedor
        function openEditVendorModal(btn) {
            const row = btn.closest('tr');
            const cells = row.querySelectorAll('td');
            const nombre = cells[0].textContent;
            const email = cells[1].textContent;
            const sucursal = cells[2].textContent;

            // Pre-cargar la información en el modal
            document.getElementById('editVendorName').value = nombre;
            document.getElementById('editVendorEmail').value = email;
            document.getElementById('editVendorSucursal').value = sucursal;
            document.getElementById('editVendorPassword').value = ''; // Limpiar el campo de contraseña

            // Mostrar el modal
            document.getElementById('editVendorModal').style.display = 'flex';

            // Guardar la fila para editar después
            document.getElementById('editVendorForm').dataset.rowToEdit = row.rowIndex;
        }

        // Cerrar los modales
        function closeModal() {
            document.getElementById('addVendorModal').style.display = 'none';
        }

        function closeEditModal() {
            document.getElementById('editVendorModal').style.display = 'none';
        }

        // Eliminar un vendedor
        function deleteVendor(btn) {
            const row = btn.closest('tr');
            row.remove();
        }

        // Editar un vendedor
        document.getElementById('editVendorForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const nombre = document.getElementById('editVendorName').value;
            const email = document.getElementById('editVendorEmail').value;
            const sucursal = document.getElementById('editVendorSucursal').value;

            // Obtener la fila para editar
            const rowToEdit = document.getElementById('editVendorForm').dataset.rowToEdit;
            const selectedRow = vendorsTable.rows[rowToEdit];

            // Actualizar los datos en la tabla
            selectedRow.cells[0].textContent = nombre;
            selectedRow.cells[1].textContent = email;
            selectedRow.cells[2].textContent = sucursal;
            closeEditModal();
        });
    </script>
</body>
</html>
